# ASOUL 直播弹幕分类
对ASOUL直播间的弹幕用kmean进行分类

⚡️ Quick start
1. 下载repo
```
git clone https://github.com/pren1/asoul_danmaku_simulator
```

2. 下载相关数据库 ASOUL_dataset

[下载链接](https://share.weiyun.com/19JjQ7JY)

database数据库来源于[这里](https://github.com/dd-center/bilibili-vtuber-danmaku/). 其中包含了ASOUL直播间以及五位成员直播间的截止5月22日的过往弹幕。

3. 数据预处理

从ASOUL_dataset提取弹幕&发送时间, 运行以下脚本会生成databse文件夹。
```
python3 Dataset_builder.py
```

利用结巴分词等算法预处理，运行以下脚本会生成Cleaned_databse文件夹。
⚠注意：此过程非常耗费时间！在六十四核的服务器上跑了一小时才跑完。️
```
python3 Dataset_processor.py
```
4. 训练K-mean

利用一个步长为100条弹幕，宽为200条弹幕的窗口切割各场直播间弹幕。所得结果利用tf-idf+k_mean训练。k_mean的最佳class数目为多次实验得到。
```
python3 Cluster_trainer.py
```

🎉 输出结果

k-mean类数选择为27，以下是各个分类频率前十的弹幕。数字代表出现数目：

```json5
{0: [('坏女人', 29518),
     ('好女人', 16818),
     ('好', 2019),
     ('什么好女人', 1850),
     ('可爱捏', 1584),
     ('什么坏女人', 1568),
     ('好好好', 1477),
     ('坏了', 1378),
     ('绷不住了', 1363),
     ('笑死', 1313)],
 1: [('快快快快快快快快快快快快快快快快快快快快', 52053),
     ('快快快快快快', 45442),
     ('快快快快快快快快快', 45058),
     ('快快快快快快快快快快快快', 43992),
     ('快快快快快快快', 30749),
     ('快快快快快快快快', 29850),
     ('快快快快快快快快快快', 28515),
     ('快快快', 27081),
     ('快快快快快', 26734),
     ('快快快快快快快快快快快', 23085)],
 2: [('风情', 40203),
     ('烧', 6964),
     ('口水黄豆', 2805),
     ('风情！', 2000),
     ('好', 1765),
     ('好好好', 1707),
     ('\\珈乐/\\珈乐/\\珈乐/\\珈乐/\\珈乐/', 1684),
     ('可爱捏', 1370),
     ('细说', 1087),
     ('\\嘉然/\\嘉然/\\嘉然/\\嘉然/\\嘉然/', 1081)],
 3: [('\\嘉晚饭/\\嘉晚饭/\\嘉晚饭/\\嘉晚饭/', 9830),
     ('嘉晚饭', 2047),
     ('可爱', 1880),
     ('\\嘉晚饭/\\嘉晚饭/\\嘉晚饭/', 1764),
     ('可爱捏', 1641),
     ('好好好', 1641),
     ('嘉晚饭是真的', 1112),
     ('好', 1076),
     ('贴贴捏', 1006),
     ('嘉晚饭！', 719)],
 4: [('嘉门', 30310),
     ('泪目', 2726),
     ('可爱捏', 2197),
     ('\\嘉然/\\嘉然/\\嘉然/\\嘉然/\\嘉然/', 1220),
     ('小的要来了', 966),
     ('圣嘉然', 917),
     ('嘉然', 654),
     ('一眼真', 638),
     ('笑死', 631),
     ('好', 626)],
 5: [('大聪明', 16077),
     ('大的要来了', 15501),
     ('什么大小姐', 11004),
     ('绷不住了', 3103),
     ('可爱捏', 2954),
     ('大的来了', 2149),
     ('大', 2135),
     ('大大大', 2028),
     ('什么大聪明', 2025),
     ('好', 1661)],
 6: [('可爱捏', 55406),
     ('绷不住了', 43155),
     ('好', 37958),
     ('好好好', 29714),
     ('笑死', 28835),
     ('ybb', 27911),
     ('可爱', 27389),
     ('拿下', 25302),
     ('麻了', 22902),
     ('乃琳', 22708)],
 7: [('才八点', 38938),
     ('晚安', 18892),
     ('晚安捏', 13827),
     ('带我走吧', 8335),
     ('寄', 8283),
     ('我急了', 7584),
     ('寄！', 6106),
     ('卧槽，别', 5738),
     ('呜呜呜', 5662),
     ('别', 5444)],
 8: [('00000000000000000000', 30474),
     ('000000000000', 11301),
     ('00000000000', 11197),
     ('0000000000', 11073),
     ('0000000000000', 10879),
     ('\\乃琳/\\乃琳/\\乃琳/\\乃琳/\\乃琳/', 10414),
     ('000000000', 10253),
     ('00000000000000', 9730),
     ('00000000', 9588),
     ('000000000000000', 9356)],
 9: [('哈人', 36619),
     ('害怕', 5182),
     ('太哈人了', 2610),
     ('笑死', 1191),
     ('绷不住了', 1058),
     ('可爱捏', 921),
     ('我先run了', 577),
     ('卧槽', 522),
     ('欧内的手', 519),
     ('嘉门', 507)],
 10: [('土土土', 8376),
      ('土', 8033),
      ('土土土土土', 4214),
      ('土土土土土土', 4001),
      ('土土土土', 2880),
      ('下雨了', 2701),
      ('土土土土土土土', 2196),
      ('土土土土土土土土', 1871),
      ('绷不住了', 1632),
      ('一眼偷', 1523)],
 11: [('珈乐', 57632),
      ('\\珈乐/\\珈乐/\\珈乐/\\珈乐/\\珈乐/', 18953),
      ('贝拉', 14660),
      ('向晚', 12705),
      ('乃琳', 10600),
      ('嘉然', 8728),
      ('\\珈乐/\\珈乐/\\珈乐/\\珈乐/', 4803),
      ('乐乐乐乐乐乐', 4050),
      ('风情', 3880),
      ('乐乐乐乐乐乐乐乐', 3571)],
 12: [('可爱捏', 59114),
      ('然然超可爱', 35041),
      ('可爱', 21667),
      ('绷不住了', 4627),
      ('可爱可爱', 4277),
      ('\\然然/\\然然/\\然然/\\然然/\\然然/', 3583),
      ('口水黄豆', 2959),
      ('好好好', 2777),
      ('好', 2766),
      ('\\嘉然/\\嘉然/\\嘉然/\\嘉然/\\嘉然/', 2712)],
 13: [('mua', 34756),
      ('可爱捏', 2493),
      ('好好好', 1654),
      ('Mua', 1310),
      ('好', 1216),
      ('要mua', 1103),
      ('木马', 1038),
      ('收到收到收到', 891),
      ('\\嘉然/\\嘉然/\\嘉然/\\嘉然/\\嘉然/', 811),
      ('这下tom了', 764)],
 14: [('88888888888888888888', 12316),
      ('晚安', 7868),
      ('8888888888', 6466),
      ('888888888', 6214),
      ('888888888888', 6098),
      ('88888888888', 6090),
      ('88888888', 6084),
      ('8888888888888', 5710),
      ('88888888888888', 5523),
      ('888888888888888', 4849)],
 15: [('嘉然', 89909),
      ('\\嘉然/\\嘉然/\\嘉然/\\嘉然/\\嘉然/', 38400),
      ('贝拉', 26003),
      ('\\嘉然/\\嘉然/\\嘉然/\\嘉然/', 13901),
      ('向晚', 13784),
      ('乃琳', 9046),
      ('\\然然/\\然然/\\然然/\\然然/\\然然/', 7415),
      ('可爱捏', 6783),
      ('珈乐', 6302),
      ('⎛⎝≥⏝⏝≤⎠⎞嘉然⎛⎝≥⏝⏝≤⎠⎞', 4395)],
 16: [('77777777777777777777', 3850),
      ('7777777', 2480),
      ('7777777777', 2442),
      ('77777777', 2400),
      ('777777777', 2308),
      ('77777777777', 2240),
      ('777777777777', 1927),
      ('7777777777777', 1898),
      ('77777777777777', 1783),
      ('777777', 1614)],
 17: [('细说', 52928),
      ('B', 18547),
      ('A', 17353),
      ('b', 15577),
      ('c', 11648),
      ('D', 11548),
      ('C', 10518),
      ('d', 9745),
      ('a', 8551),
      ('口水黄豆', 3199)],
 18: [('收到收到收到', 40236),
      ('收到收到', 4912),
      ('收到', 4031),
      ('好好好', 3797),
      ('好女人', 1976),
      ('收到收到收到收到', 1796),
      ('这下tom了', 1612),
      ('大腿别着凉了', 1568),
      ('泪目', 1521),
      ('好', 1476)],
 19: [('泪目', 35430),
      ('呜呜呜', 3242),
      ('绷不住了', 3079),
      ('泪目了', 1892),
      ('一眼偷', 1825),
      ('好女人', 1785),
      ('好', 1590),
      ('好好好', 1441),
      ('一眼真', 1357),
      ('蚌埠住了', 1054)],
 20: [('好好好', 39370),
      ('好', 37190),
      ('晚上好', 19247),
      ('就好这口', 16529),
      ('好耶', 15598),
      ('好好好好好', 8943),
      ('好！', 8562),
      ('hi', 7628),
      ('好好好好好好', 7352),
      ('可爱捏', 6356)],
 21: [('下雨了', 47183),
      ('绷不住了', 3901),
      ('笑死', 2555),
      ('麻了', 2219),
      ('可爱捏', 1648),
      ('拉了', 1463),
      ('蚌埠住了', 1274),
      ('ybb', 1059),
      ('我不到啊', 1025),
      ('好', 925)],
 22: [('绷不住了', 50571),
      ('笑死', 40376),
      ('向晚', 27736),
      ('拉了', 19192),
      ('蚌埠住了', 15323),
      ('可爱捏', 12111),
      ('\\向晚/\\向晚/\\向晚/\\向晚/\\向晚/', 8401),
      ('可爱', 7646),
      ('麻了', 6891),
      ('好', 6372)],
 23: [('贝拉', 72570),
      ('嘉然', 23517),
      ('\\贝拉/\\贝拉/\\贝拉/\\贝拉/\\贝拉/', 23108),
      ('向晚', 9527),
      ('\\贝拉/\\贝拉/\\贝拉/\\贝拉/', 7681),
      ('乃琳', 4410),
      ('珈乐', 3980),
      ('贝拉贝拉', 3559),
      ('\\贝拉/\\贝拉/\\贝拉/', 2990),
      ('可爱', 2165)],
 24: [('狂', 19367),
      ('狂！', 7968),
      ('狂小贝', 3105),
      ('好', 1719),
      ('狂小然', 1155),
      ('嘉然', 1136),
      ('贝拉', 1020),
      ('绷不住了', 972),
      ('可爱捏', 812),
      ('狂小晚', 768)],
 25: [('通过', 134009),
      ('不通过', 8368),
      ('通过通过', 6117),
      ('可爱捏', 2558),
      ('好', 2446),
      ('好好好', 1756),
      ('绷不住了', 1584),
      ('通过通过通过', 1551),
      ('通过！', 1071),
      ('很难不通过', 1063)],
 26: [('工具人有难了', 5920),
      ('工具人你给我下来', 3911),
      ('绷不住了', 3099),
      ('好', 3000),
      ('工具人能处', 2983),
      ('可爱捏', 2818),
      ('好好好', 2353),
      ('可爱', 1796),
      ('笑死', 1764),
      ('工具人', 1716)]}
```